<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>  Patrick-Ni</title>
<meta name="description" content="splash">


  <meta name="author" content="Patrick's personal blog">
  
  <meta property="article:author" content="Patrick's personal blog">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Patrick-Ni">
<meta property="og:title" content="Patrick-Ni">
<meta property="og:url" content="http://localhost:4000/210813161/">


  <meta property="og:description" content="splash">



  <meta property="og:image" content="http://localhost:4000/assets/images/site-logo.png">



  <meta name="twitter:site" content="@mmistakes">
  <meta name="twitter:title" content="Patrick-Ni">
  <meta name="twitter:description" content="splash">
  <meta name="twitter:url" content="http://localhost:4000/210813161/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="http://localhost:4000/assets/images/site-logo.png">
    
  

  



  <meta property="article:published_time" content="2021-11-08T11:47:10+00:00">





  

  


<link rel="canonical" href="http://localhost:4000/210813161/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Patrick's personal blog",
      "url": "http://localhost:4000/",
      "sameAs": ["https://twitter.com/mmistakes","https://www.facebook.com/michaelrose"]
    
  }
</script>


  <meta name="google-site-verification" content="UQj93ERU9zgECodaaXgVpkjrFn9UrDMEzVamacSoQ8Y" />






<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Patrick-Ni Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>


<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?...">
</script>
<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
   jax: ["input/TeX", "output/HTML-CSS"],
   tex2jax: {
       inlineMath: [ ['$', '$'] ],
       displayMath: [ ['$$', '$$']],
       processEscapes: true,
       skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'] },
   messageStyle: "none",
   "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
  });
</script>
    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/javascript" src="/assets/css/MathJax.css"></script>
  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Patrick-Ni
          <span class="site-subtitle"></span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/">Home</a>
            </li><li class="masthead__menu-item">
              <a href="/Papers/">Papers</a>
            </li><li class="masthead__menu-item">
              <a href="/Codes/">Codes</a>
            </li><li class="masthead__menu-item">
              <a href="/articles/">Articles</a>
            </li><li class="masthead__menu-item">
              <a href="/author/">About-me</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">NLP</span>
        

        
        <ul>
          
            <li><a href="/Story-generating/">Story Generating</a></li>
          
            <li><a href="/Prompt-based/">Prompt-based</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="">
    <meta itemprop="description" content="splash">
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/210813161/" class="u-url" itemprop="url">
</a>
          </h1>
          


        </header>
      

      <section class="page__content e-content" itemprop="text">
        <h1>Differentiable Prompt Makes Pre-trained Language Models Better Few-shot Learners</h1>

<p>可区分提示使预训练语言模型更好</p>

<h2>Abstract</h2>

<p>大规模预训练语言模型通过展示作为少样本学习者的卓越能力，对自然语言处理做出了重大贡献。然而，它们的有效性主要取决于模型参数的缩放和快速设计，阻碍了它们在大多数实际应用中的实现。</p>

<p>本研究提出了一种名为 DifferentiAble pRompT (DART) 的新型<strong>可插拔、可扩展</strong>和高效方法，该方法可以将小型语言模型转换为更好的少样本学习器，而无需任何提示工程。这种方法背后的主要原理涉及将<strong>潜在的自然语言处理任务重新构建为预训练语言模型的任务，并通过反向传播对提示模板和目标标签进行差异化优化</strong>。</p>

<p>此外，所提出的方法可以是：</p>

<ul>
  <li>插入任何预先训练的语言模型；</li>
  <li>扩展到广泛的分类任务。</li>
</ul>

<p>对标准 NLP 任务的综合评估表明，所提出的方法实现了更好的少拍性能(few-shot performance)。</p>

<h2>1	Introduction</h2>

<h5>(1)	存在的问题</h5>

<p>大规模预训练模型面临小样本学习(<a href="https://zhuanlan.zhihu.com/p/61215293">few-shot learning</a>)的挑战。</p>

<h5>(2)	已有的解决方法</h5>

<p>一种新型微调方法，可以为较小的语言模型 (LM) 配备少量功能：通过完成完形填空任务，将预训练的 LM 直接用作预测器，它将下游任务视为masked language modeling problem。这些提示可用于微调，为分类器提供额外的任务信息，尤其是在低数据情况下。</p>

<p>难点：获得优化的提示模板和目标标签标记并非易事。</p>

<h5>(3)	本文提出的方法</h5>

<p>DART，可区分提示的微调方法。关键思想是利用语言模型中的一些参数（未使用的标记）作为模板和标签标记，并使用<a href="https://blog.csdn.net/bitcarmanlee/article/details/78819025">反向传播</a>在连续空间中优化它们。</p>

<p>本文提出了一个两阶段的优化算法，首先是学习模板和标签，然后是整体参数。进一步引入了一个辅助流畅性约束对象来确保提示嵌入之间的关联。</p>

<p><img src="../../assets/images/typora img/image-20210918211435771.png" alt="image-20210918211435771" /></p>

<h2>2	Related Work</h2>

<p><strong>Language Modeling Prompt</strong>：最近在该领域进行的研究一直专注于自动搜索提示。</p>

<ul>
  <li>提出了 PET，它将 NLP 任务重新制定为完形填空式问题并执行基于梯度的微调。</li>
  <li>在微调期间使用更密集的监督对象改进 PET。</li>
  <li>建议使用 AUTOPROMPT 为基于梯度引导搜索的各种任务创建提示。</li>
  <li>提出了一种称为 PTR 的方法，它利用逻辑规则为多类文本分类构造带有子提示的提示。</li>
  <li>将潜在的 NLP 任务重新表述为一个蕴涵任务，然后用少量样本对模型进行微调。</li>
  <li>提出了一种通过校准将外部知识图整合到语言表达器中的方法。</li>
  <li>提出了 LM-BFF——更好的语言模型的少量微调，它利用 T5 [35] 在词汇表中生成模板和搜索标签标记。</li>
</ul>

<p>然而，使用生成模型和带有验证的标签搜索是计算密集型的。此外，由于神经网络的连续性，对离散空间的快速搜索是次优的。</p>

<p>为了克服这些限制：</p>

<ul>
  <li>提出了 P-tuning，它采用了由 LSTM 学习的可训练的连续提示嵌入。</li>
  <li>提出了一种称为 OPTIPROMPT 的有效连续方法来优化事实探查的提示。</li>
  <li>提出前缀调整，它保持语言模型参数冻结，但为自然语言生成任务优化了一个小的连续任务特定向量。</li>
  <li>提出了一种学习“软提示”的机制，以调节冻结语言模型以执行下游任务。</li>
</ul>

<p>然而，这些方法仍然需要优化外部参数（例如 P-tuning 中的 LSTM）并且容易出现复杂的标签空间。</p>

<h2>3	Backgroud</h2>

<h3>3.1	Language Model Prompt</h3>

<p>设 $X_in = {x_1, x_2,…, x_L}$ 是一个句子，其中 $x_i$ 是输入句子中的第 i 个token，L 是token的数量。 具体来说，$X_in$ 被转换为一个固定的标记序列 $\tilde{x_{in}}$，然后映射到一个隐藏向量序列 ${h_k ∈ \mathbb{} d}$。 给定输入序列 $\tilde{x_{in}} = [\mathbf{CLS}]X_{in}[\mathbf{SEP}]$，传统的微调方法利用 [CLS] 嵌入（例如，MLP 层）上的通用头层来预测输出类。 对于基于提示的方法，特定任务的模式字符串（模板 $\mathcal{T}$ ）旨在诱导模型生成对应于给定类（标签标记 $\mathcal{M} (Y)）$的文本输出——我们将这两件事一起称为一个提示。 具体来说，包含一个 [MASK] token的 $X_prompt$ 直接将 MLM 输入分配给以下任务：</p>

<p><img src="../../assets/images/typora img/image-20210919102717936.png" alt="image-20210919102717936" /></p>

<table>
  <tbody>
    <tr>
      <td>当提示输入MLM时，模型可以得到候选类的概率分布$p([MASK]</td>
      <td>(X_{prompt})$，y∈Y为：</td>
    </tr>
  </tbody>
</table>

<p><img src="../../assets/images/typora img/image-20210919102730802.png" alt="image-20210919102730802" /></p>

<p>其中 w 表示第 y 类的第 w 个标签标记。</p>

<h2>4	Our Approach</h2>

<h3>4.1	Motivation</h3>

<p>少样本学习者的预训练语言模型的改进，需要最佳提示。</p>

<h3>4.2	Differentiable Template Optimization</h3>

<p>给定模板：$\mathcal{T}={[\mathbf{T}<em>{0:i}],[\mathbf{MASK}],[\mathbf{T}</em>{i+1:j}]}$，满足$[\mathbf{T}_i]\in\mathcal{V}$，并将模板映射为：</p>

<p><img src="../../assets/images/typora img/image-20210919105815034.png" alt="image-20210919105815034" /></p>

<p>DART 将$ [\mathbf{T}_i]$ 视为伪标记并将模板映射如下：</p>

<p><img src="../../assets/images/typora img/image-20210919105910075.png" alt="image-20210919105910075" /></p>

<p>其中$ h_i(0 ≤ i ≤ j) $是可训练的参数。 可微模板优化可以获得超出原始词汇表$\mathcal{ V}$ 的表达模板。 最后，模板$h_i$ 通过以下方式进行了差异优化：</p>

<p><img src="../../assets/images/typora img/image-20210919110023884.png" alt="image-20210919110023884" /></p>

<p>提示嵌入的值 $h_i$ 必须相互依赖而不是独立。</p>

<h3>4.3	Differentiable Label Optimization</h3>

<p>基于提示的微调需要填写一个单词，并将被屏蔽的单词预测映射到一个语言器，生成一个类（即“是”：真。“否”：假）。对于每个类 $c ∈ Y$，之前的方法估计初始 L 在前 k 个词汇词的修剪集$\mathcal{ V}^ c ⊂V $上的条件似然。</p>

<p>然而，蛮力标签搜索：（1）计算量大且繁琐，因为 $\mathcal{D}_{dev}$ 通常非常大，需要多轮评估。 (2)随着类数的增加，可扩展性差（很多分类数据集有100多个类），搜索次数可能是$k^C$（C代表类的总数），这是指数级的，因此难以处理。此外，类的标签包含丰富、复杂的语义知识，一个离散的标记可能不足以表示这些信息。</p>

<p>具体来说，对于标签 $Y = {Y_1,Y_2,..,Y_m}$，不同于之前将类type  $Y_i$ 转换为可变数量的标签标记 ${…,v_1,..,v_k ,. ..}$，DART 将 $Y_j$ 映射到一个连续的词汇空间：</p>

<p><img src="../../assets/images/typora img/image-20210919112054513.png" alt="image-20210919112054513" /></p>

<p>其中$\mathcal{ M }$是模板中可训练嵌入的数量。 为避免优化任何外部参数，将 ${h_1,…,h_m,..,h_{m+n}}$ 替换为 $\mathcal{V}$ 中未使用的标记以生成$\mathcal{V}’$。</p>

<h3>4.4	Training Objectives</h3>

<p>类别区分目标 $\mathcal{L}_C$ 和流畅性约束目标 $\mathcal{L}_F$。</p>

<h5>(1)	class discrimination object</h5>

<p><img src="../../assets/images/typora img/image-20210919120732571.png" alt="image-20210919120732571" /></p>

<p>其中 CE 是交叉熵损失函数，$\mathcal{L}_C$ 代表类别区分损失。</p>

<h5>(2)	Fluency Constraint Object</h5>

<table>
  <tbody>
    <tr>
      <td>输入句子中的一个 token 被随机屏蔽，并进行屏蔽语言预测。 $x$ 和 $x’$ 分别是原始序列和掩码序列。 设 $x^m$ 为在 $x’$ 中被屏蔽的目标标记，$P(x^m</td>
      <td>x’ , y)$ 最大化如下：</td>
    </tr>
  </tbody>
</table>

<p><img src="../../assets/images/typora img/image-20210919121031277.png" alt="image-20210919121031277" /></p>

<p>通过优化$\mathcal{L}_F$ ，语言模型可以获得更好的上下文表示，模板标记之间具有丰富的关联。 我们有以下训练对象：</p>

<p><img src="../../assets/images/typora img/image-20210919121143717.png" alt="image-20210919121143717" /></p>

<p><img src="../../assets/images/typora img/image-20210919121211886.png" alt="image-20210919121211886" /></p>

<h3>4.5 Comparison to Previous Prompt-tuning Approaches</h3>

<p><img src="../../assets/images/typora img/image-20210919121519857.png" alt="image-20210919121519857" /></p>

<h2>5	Experiments</h2>

<h3>5.1 Dataset Statistics</h3>

<p>对 15 个 NLP 任务进行了全面研究，涵盖了情感分析、自然语言推理、释义、句子相似性、关系提取和事件提取。评估包括 10 个流行的句子分类数据集。</p>

<h3>5.2	Settings</h3>

<ul>
  <li>
    <p>使用Pytorch实现模型。</p>
  </li>
  <li>
    <p>使用与LM-BFF相同的设置：使用一组固定的种子Sseed测量每个任务的五个不同采样Dtrain的平均性能。</p>
  </li>
  <li>使用AdamW作为优化器。</li>
  <li>我们使用 RoBERTa-large 对分类任务进行实验，以便与 LM-BFF 进行公平比较。</li>
  <li>使用uncased BERT-large [10] 来进行关系提取数据集。</li>
</ul>

<h3>5.3	Main Result</h3>

<p><img src="../../assets/images/typora img/image-20210919122149971.png" alt="image-20210919122149971" /></p>

<h3>5.4	Ablation Study</h3>

<p>消融研究</p>

<ul>
  <li>在缺少任何一个模块（即流畅性约束对象、可微模板或可微标签）的情况下，DART 表现出性能下降，这表明所有模块都是有利的。</li>
  <li>可微标签优化对性能更敏感，并且对 DART 非常有益，尤其是对于低资源设置。</li>
</ul>

<h3>5.5	Analysis and Discussion</h3>

<h5>(1)	Can DART Applied to Other Pre-trained LMs?</h5>

<p>DART 可以应用于其他预训练的语言模型吗？</p>

<p><img src="../../assets/images/typora img/image-20210919125010019.png" alt="image-20210919125010019" style="zoom:67%;" /></p>

<p>使用 GPT-2 介质的 DART 比传统的微调方法产生更好的性能。此外，论文注意到使用 GPT-2-medium 的 DART 可以达到与 BERT-large 相当的性能。</p>

<h5>(2)	What Exactly Optimized Prompt is?</h5>

<p>什么是完全优化提示？</p>

<p>作者进行最近邻词汇嵌入搜索，将 $\mathcal{V}$ 中的 Top-3 优化伪标签标记投射到可读的自然语言中。</p>

<p>使用 t-SNE [43] 和标准化来可视化 Wiki80 数据集上的标签。</p>

<p><img src="../../assets/images/typora img/image-20210919125515730.png" alt="image-20210919125515730" style="zoom:50%;" /></p>

<h5>(3)	DART v.s. Conventional Fine-tuning</h5>

<ul>
  <li>DART 没有优化任何新参数；然而，传统的微调应该在 [CLS] 嵌入上学习一个明确的分类器，这在低数据情况下可能会失败。</li>
  <li>DART 具有与大规模语言模型预训练相同的任务设置，并且对于下游分类任务具有较小的理论上限。</li>
</ul>

<h5>(4)	Limitations</h5>

<p>当任务语料库的分布与预训练语料库的分布不同时，DART可能会失败。此外，DART还显示了与超参数相关的不稳定性， NLP 中少样本学习的波动性。</p>

<h2>6	Conclusion and Future Work</h2>

<p>本文介绍了 DART，这是一种简单而有效的微调方法，可改进快速学习预训练语言模型。与传统的微调方法相比，所提出的方法可以在少拍场景中产生令人满意的改进。所提出的方法也可用于其他语言模型，并可扩展到其他任务，例如意图检测。直观地说，本研究中获得的结果可用于激发 NLP 小样本学习的两个未来研究方向：</p>

<ul>
  <li>将所提出的方法扩展到半监督设置以进一步利用未标记数据；</li>
  <li>将所提出的方法扩展到少拍终身学习，而提示必须通过自适应任务进行优化。</li>
</ul>


        
      </section>

      <footer class="page__meta">
        
        


        

      </footer>

      

      <!---->
<!--  <nav class="pagination">-->
<!--    -->
<!--      <a href="/201810604/" class="pagination&#45;&#45;pager" title="
">Previous</a>-->
<!--    -->
<!--    -->
<!--      <a href="/210901652/" class="pagination&#45;&#45;pager" title="
">Next</a>-->
<!--    -->
<!--  </nav>-->
<!---->
    </div>

    
  </article>

  
  
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="search-searchbar"></div>
  <div class="search-hits"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://github.com/Patrick-Ni/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://instagram.com/mmistakes" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-weibo" aria-hidden="true"></i> Weibo</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 Patrick's personal blog. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>


<!-- Including InstantSearch.js library and styling -->
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch-theme-algolia.min.css">

<script>
// Instanciating InstantSearch.js with Algolia credentials
const search = instantsearch({
  appId: 'QB6HVGBSBA',
  apiKey: '9d5014e5bbc77372547bce778dfa5663',
  indexName: 'minimal_mistakes',
  searchParameters: {
    restrictSearchableAttributes: [
      'title',
      'content'
    ]
  }
});

const hitTemplate = function(hit) {
  const url = hit.url;
  const title = hit._highlightResult.title.value;
  const content = hit._highlightResult.html.value;

  return `
    <div class="list__item">
      <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
        <h2 class="archive__item-title" itemprop="headline"><a href="${url}">${title}</a></h2>
        <div class="archive__item-excerpt" itemprop="description">${content}</div>
      </article>
    </div>
  `;
}

// Adding searchbar and results widgets
search.addWidget(
  instantsearch.widgets.searchBox({
    container: '.search-searchbar',
    poweredBy: true,
    placeholder: 'Enter your search term...'
  })
);
search.addWidget(
  instantsearch.widgets.hits({
    container: '.search-hits',
    templates: {
      item: hitTemplate,
      empty: 'No results',
    }
  })
);

// Starting the search only when toggle is clicked
$(document).ready(function () {
  $(".search__toggle").on("click", function() {
    if(!search.started) {
      search.start();
    }
  });
});
</script>








  </body>
</html>