<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>  Patrick-Ni</title>
<meta name="description" content="splash">


  <meta name="author" content="Patrick's personal blog">
  
  <meta property="article:author" content="Patrick's personal blog">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Patrick-Ni">
<meta property="og:title" content="Patrick-Ni">
<meta property="og:url" content="http://localhost:4000/210903564/">


  <meta property="og:description" content="splash">



  <meta property="og:image" content="http://localhost:4000/assets/images/site-logo.png">



  <meta name="twitter:site" content="@mmistakes">
  <meta name="twitter:title" content="Patrick-Ni">
  <meta name="twitter:description" content="splash">
  <meta name="twitter:url" content="http://localhost:4000/210903564/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="http://localhost:4000/assets/images/site-logo.png">
    
  

  



  <meta property="article:published_time" content="2021-11-08T09:39:58+00:00">





  

  


<link rel="canonical" href="http://localhost:4000/210903564/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Patrick's personal blog",
      "url": "http://localhost:4000/",
      "sameAs": ["https://twitter.com/mmistakes","https://www.facebook.com/michaelrose"]
    
  }
</script>


  <meta name="google-site-verification" content="UQj93ERU9zgECodaaXgVpkjrFn9UrDMEzVamacSoQ8Y" />






<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Patrick-Ni Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>


<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?...">
</script>
<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
   jax: ["input/TeX", "output/HTML-CSS"],
   tex2jax: {
       inlineMath: [ ['$', '$'] ],
       displayMath: [ ['$$', '$$']],
       processEscapes: true,
       skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'] },
   messageStyle: "none",
   "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
  });
</script>
    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/javascript" src="/assets/css/MathJax.css"></script>
  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Patrick-Ni
          <span class="site-subtitle"></span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/">Home</a>
            </li><li class="masthead__menu-item">
              <a href="/Papers/">Papers</a>
            </li><li class="masthead__menu-item">
              <a href="/Codes/">Codes</a>
            </li><li class="masthead__menu-item">
              <a href="/Articles/">Articles</a>
            </li><li class="masthead__menu-item">
              <a href="/author/">About-me</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">NLP</span>
        

        
        <ul>
          
            <li><a href="/Story-generating/">Story Generating</a></li>
          
            <li><a href="/Prompt-based/">Prompt-based</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="">
    <meta itemprop="description" content="splash">
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/210903564/" class="u-url" itemprop="url">
</a>
          </h1>
          


        </header>
      

      <section class="page__content e-content" itemprop="text">
        <h2>NSP-BERT: A Prompt-based Zero-Shot Learner Through an Original Pre-training Task —— Next Sentence Prediction</h2>

<p>NSP-BERT：通过原始预训练任务的基于提示的零样本学习器——下一句预测</p>

<h2>1	Introduction</h2>

<p><img src="../../assets/images/typora img/image-20210914000329329.png" alt="image-20210914000329329" /></p>

<p>论文主要贡献：</p>

<ul>
  <li>NSP-BERT 在不使用任何特定任务的训练数据的情况下，在零样本模型中实现了 SOTA 性能。</li>
  <li>提出了两种替代的label/answer mapping方法。</li>
  <li>使用软定位和两阶段提示构建方法来缓解基于句子级提示的模型对标记位置不敏感的问题。</li>
  <li>证明了一个简单的基于交互模型的句子级对比学习预训练任务可以很好地适应基于提示的学习并解决各种 NLP 任务。</li>
</ul>

<h2>2	Related Work</h2>

<p>一些关于zero-shot 和few-shot的prompt-learning的模型和任务。</p>

<ul>
  <li>
    <p><strong>MLM/L2R LM</strong>：token-level prompt-learning methods。</p>
  </li>
  <li><strong>Sentence-Level Prompt-Learning **：</strong>EFL**将 NLP 任务重新表述为 sentence entailment-style tasks。输入/标签对：”x: [CLS] The Italian team won the European Cup. [SEP] This is Sports news.[EOS], y: Entail”。 EFL 模型可以在少样本学习上表现良好，但在零样本任务上表现不佳。</li>
  <li><strong>Automated Prompt</strong>：自动搜索，生成提示。<strong>LMBFF</strong>模型使用条件似然自动选择标签词，并使用 T5 生成模板。 <strong>AUTOPROMPT **使用梯度引导搜索来创建提示。 与上述离散提示搜索方法相比，</strong>P-tuning** 采用可训练的连续提示嵌入，通过 P-tuning，GPT 在监督学习中实现了与类似大小的 BERT 相当甚至更好的性能。</li>
  <li><strong>optimization methods in prompt-learning</strong>：<strong>ADAPET</strong>通过在完整的原始输入上分离label token的损失和label-conditioned的 MLM 目标来使用更多的supervision。 PTR结合了逻辑规则，用几个简单的子提示来组成特定于任务的提示。指出 GPT 中存在 3 种类型的偏差（多数标签偏差、新近偏差和普通标记偏差）。 通过使用无内容输入（例如“N/A”）来校准模型的输出概率，GPT-2 和 GPT-3 的性能得到了显着提高。</li>
</ul>

<h2>3	Framework of NSP-BERT NSP-BERT</h2>

<h3>3.1	Next Sentence Prediction</h3>

<p>NSP ——BERT模型的两个基本预训练任务之一，同时将两个句子 A 和 B 输入到 BERT 中，以预测句子 B 是否在同一文档中的句子 A 之后。 在特定训练中，有 50% 的时间，B 是 A 之后的实际下一个句子（IsNext），另外 50% 的时间，作者使用语料库中的随机句子（NotNext）。</p>

<h5>(1)	等式</h5>

\[q_M(n_k|X_i)=\frac{\exp{s(n_k|x_i^{(1)},x_i^{(2)})}}{\sum_{n}{\exp{s(n|x_i^{(1)},x_i^{(2)})}}}\]

<ul>
  <li>$M$表示在大规模语料库上训练的模型。</li>
  <li>$X_i{(1)}$ 和 $X_i{(2)}$ 分别表示句子 A 和句子 B。 模型的输入是 $X_{input}$，$q_M$ 表示模型的 NSP 头部的输出概率。</li>
  <li>$s = W_{nsp}h_{[CLS]}$，其中 $h_{[CLS]}$ 是 [CLS] 的隐藏向量，$W_{nsp}$ 是 NSP 任务学习的矩阵，$W_{nsp} ∈ R^{2×H}$。</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>NSP 任务的损失函数 $L_{NSP} = − logq_M(n</td>
          <td>x)$ ，其中 $n ∈ {IsNext, NotNext}$。</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<h5>(2)	NSP任务不是确定两个短语的顺序，而是确定他们是否具有相同的主题</h5>

<h5>(3)	NSP任务与对比学习任务非常相似具有逻辑推理能力：</h5>

<ul>
  <li>NSP任务是interactive的，token不仅可以与本句子中的其他token交互，也可以和别的句子的token交互。</li>
  <li>NSP 任务与 MLM 任务一起训练。 MLM任务为整个模型的self-attention机制提供了训练基础。</li>
</ul>

<h3>3.2	Prompts in NSP-BERT</h3>

<p>NSP-BERT 与其他基于提示的学习方法一样，需要为各种任务构建合适的模板。 由于 NSP-BERT 不依赖任何下游任务的训练数据，因此模板的构建形式必须与原始 NSP 任务紧密匹配。 本节展示如何为不同的任务构建模板。</p>

<h5>(1)	Single Sentence Task</h5>

<p>样本必须在单句任务中分类为不同的主题，比如情感分析是将文本分类为各种感情趋势。</p>

<p>假设单句分类任务的训练数据集D：
\(D = \{(x_i,y_i)\}_{i=1}^{N}\)
 $x_i$ 是总共 N 个样本中的第 i 个句子，$x_i$ 的标签为 $y_i$ ，可以映射到 $y ^{(j)} ∈ Y$，其中 $|Y| = M$，M 是这个数据集中的主题数。 对于每个 $y^{(j)} $，它将被映射到一个模板 $p^{(j)} ∈ P$。模型的输入将是:
\(X_{input} = [CLS]x_i[SEP]p^{(j)}[EOS]\)
样本$x_i$的标签为$y^{(j)}$的概率：
\(q(y^{j}|x_i) = \frac{\exp{q_M(n=IsNext|x_i,p^{(j)})}}{\sum_{p^{(k)}∈P}{\exp{q_M(n=IsNext|x_i,p^{(k)})}}}\)</p>

<h5>(2)	Sentence Pair Task</h5>

<p>句子对任务旨在识别两个句子之间的关系，这种类型的数据集$D={(x_i^{(1)},x_i^{(2)},y_i}_{i=1}^N$包含 N 个样本，每个样本有 2 个句子 $x _i^{(1)} $ 和$ x _i^{(2)} $。 它们之间的关系是 $y^i $，可以映射到 $y ^{(j)} ∈ Y$，其中$|Y| = M$，是关系类型的数量。NSP模型的输出为：
\(q(x_i)=q_M(n=IsNext|x_i^{(1)},x_i^{(2)})\)</p>

<h5>(3)	Cloze-Style Task</h5>

<p>完形填空式任务是给出一个带有空格的句子，模型必须找到最合适的token或span来填充空格。</p>

<p>数据集$ D = {(x_i , c <em>i^{(1)}  , …, c _i^{(j)} , …, y_i)}</em>{i=1}^N$。对于每个样本，有一个 [BLANK] 的句子$ x_i$，并且有 $K_i $候选 ${c <em>i^{(j)}  }</em>{j=1}^{K_i} $可供选择。 对于每个选项$c_i^{(j)}$，都有一个模板 $p _i^{(j) } ∈ P_i$ 与之对应。 对于输入：
\(X_{input}=[CLS]x_i[SEP]p_i^{(j)}[EOS]\)
输出模型：
\(q(y_i^{(j)}|x_i)=\frac{\exp{q_M(n=IsNext|x_i,p_i^{(j)})}}{\sum{p_i^{(k)∈P_i}\exp{q_M(n=IsNext|x_i,p_i^{(k)})}}}\)
<img src="../../assets/images/typora img/image-20210913224015459.png" alt="image-20210913224015459" /></p>

<p>采用soft-position index，允许NSP像MLM一样工作，将候选词coin的位置索引与[BLANK]对齐。</p>

<h5>(4)	Word Sense Disambiguation</h5>

<p>在完全监督的训练场景中，作者可以在单词前后添加标记来识别要消歧的单词。</p>

<p><img src="../../assets/images/typora img/image-20210913231110050.png" alt="image-20210913231110050" /></p>

<p>因为没有用于句子级提示学习的下游任务训练数据，所以无法通过标记来识别目标词的位置。 论文提出了一种 TwoStage Prompt 构造方法，在NSP-BERT 中使用自然语言描述来指示目标词。</p>

<ul>
  <li>stage1：在句子 A 的末尾提示目标词。这个阶段的目的是为目标词提供足够的上下文。</li>
  <li>stage2：提示对句子 B 中候选词义的描述。</li>
</ul>

<p>将两阶段提示输入语言模型，判断句子是否流畅合理。 让 $p_{i,1}^{(j)}$ ,$p_{i,2}^{(j)}$ 表示提示的第一部分和第二部分。 模型的输入是：
\(X_{input}=[CLS]x_i,p_{i,1}^{(j)}[SEP]p_{i,2}^{(j)}[EOS]\)</p>

<h3>3.3	Answering Mapping</h3>

<p>候选-对比答案映射和样本-对比答案映射</p>

<p><img src="../../assets/images/typora img/image-20210913235101753.png" alt="image-20210913235101753" /></p>

<p>(1)	<strong>Candidates-Contrast</strong>用于具有多个候选的数据集，例如候选情绪、候选主题、候选习语和候选实体。 对于上述数据集，有一个模板$p_i^{(j)}$(或$p_i$)对应标签$y_i^{(j)}$(或$y_i$)。 在条件为IsNext的情况下，将候选者中M输出的概率最高的作为最终输出答案：
\(\hat{y_i}=\arg{\max_j{q(y_i^{(j)}|x_i)}}=\arg{\max_j{n=IsNext|x_i,p_i^{(j)})}}\)
(2)	<strong>Sample-Contrast</strong>针对没有对比候选的数据集，算法：</p>

<p><img src="../../assets/images/typora img/image-20210913235113979.png" alt="image-20210913235113979" style="zoom:67%;" /></p>

<h2>4	Experiment</h2>

<h3>4.1	Task and Datasets</h3>

<p>在FewCLUE上评估模型，其中包含9 个中文<a href="https://www.jianshu.com/p/d713678fddfb">NLU</a>（自然语言理解） 任务，4 个单句任务、3 个句子对任务和2 个阅读理解任务。 数据集的详细信息显示在附录中。 每个训练集中的样本数量很少，每个标签对应8或16个样本。</p>

<p>DuEL2.0 为了进一步验证NSPBERT在词义消歧方面的能力，增加了实体链接数据集DuEL2.0。 特别地，作者将 DuEL2.0 分为两部分。 第一部分，实体链接部分，有26586个样本。 所有样本的mention 可以映射到知识库中的单个或多个实体，每个mention 平均可以链接到5.37 个实体。 第二部分，实体类型部分，有6465个样本。 这些样本的提及在知识库中是找不到的，但是它们会被划分到它们对应的上层实体类型中。 共有 24 种上层实体类型。</p>

<h3>4.2	Baselines</h3>

<p>三个训练场景</p>

<ul>
  <li>
    <p><strong>Fine-Tuning</strong> 在FewCLUE 训练集上对预训练语言模型进行标准微调。 模型使用交叉熵损失进行微调，并使用 BERT 样式模型的隐藏向量 [CLS]，$h_{[CLS]}$ 和分类层$ softmax(Wh_{[CLS]})$，其中 $W ∈ R^{M×H}$，M 是数字 的标签。</p>
  </li>
  <li>
    <p><strong>Few-shot</strong> 选择token-level模型 PET其优化模型 ADAPET、P-tuning和 LM -BFF。 论文还选择句子级模型 EFL。 所有的小样本模型都是在FewCLUE 的训练集上训练的。</p>
  </li>
  <li>
    <p><strong>Zero-Shot</strong> 在零样本场景中，有两种实现方式，一种是使用 L2R LM 的 GPT-ZERO，另一种是使用 MLM 的 PET-ZERO。</p>
  </li>
</ul>

<h3>4.3	experiment settings</h3>

<p>BERT 模型使用 <a href="https://blog.csdn.net/abc50319/article/details/107903416">RoBERTa-wwm-ext</a>.</p>

<p>GPT 模型是 NEZHA-Gen 。论文采用了 UER 使用 MLM 和 NSP 训练的 vanilla BERT 。</p>

<p>预训练语料库是一个大型的中文混合语料库。 连同基本模型（L=12，H=768，A=12，总参数=110M），论文使用各种尺度（很小小、小和大）的UER-BERTs进行实验，以验证各种尺度模型在 NSP-BERT 上的效果 。</p>

<h3>4.4	Main Results</h3>

<p><img src="../../assets/images/typora img/image-20210914110018684.png" alt="image-20210914110018684" /></p>

        
      </section>

      <footer class="page__meta">
        
        


        

      </footer>

      

      <!---->
<!--  <nav class="pagination">-->
<!--    -->
<!--      <a href="/210901652/" class="pagination&#45;&#45;pager" title="
">Previous</a>-->
<!--    -->
<!--    -->
<!--      <a href="/210904332/" class="pagination&#45;&#45;pager" title="
">Next</a>-->
<!--    -->
<!--  </nav>-->
<!---->
    </div>

    
  </article>

  
  
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="search-searchbar"></div>
  <div class="search-hits"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://github.com/Patrick-Ni/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://instagram.com/mmistakes" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-weibo" aria-hidden="true"></i> Weibo</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 Patrick's personal blog. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>


<!-- Including InstantSearch.js library and styling -->
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch-theme-algolia.min.css">

<script>
// Instanciating InstantSearch.js with Algolia credentials
const search = instantsearch({
  appId: 'QB6HVGBSBA',
  apiKey: '9d5014e5bbc77372547bce778dfa5663',
  indexName: 'minimal_mistakes',
  searchParameters: {
    restrictSearchableAttributes: [
      'title',
      'content'
    ]
  }
});

const hitTemplate = function(hit) {
  const url = hit.url;
  const title = hit._highlightResult.title.value;
  const content = hit._highlightResult.html.value;

  return `
    <div class="list__item">
      <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
        <h2 class="archive__item-title" itemprop="headline"><a href="${url}">${title}</a></h2>
        <div class="archive__item-excerpt" itemprop="description">${content}</div>
      </article>
    </div>
  `;
}

// Adding searchbar and results widgets
search.addWidget(
  instantsearch.widgets.searchBox({
    container: '.search-searchbar',
    poweredBy: true,
    placeholder: 'Enter your search term...'
  })
);
search.addWidget(
  instantsearch.widgets.hits({
    container: '.search-hits',
    templates: {
      item: hitTemplate,
      empty: 'No results',
    }
  })
);

// Starting the search only when toggle is clicked
$(document).ready(function () {
  $(".search__toggle").on("click", function() {
    if(!search.started) {
      search.start();
    }
  });
});
</script>








  </body>
</html>